ThinkPad JIS → US RDP Keymap
詳細使用マニュアル（配布版 v1.3）
========================================

本ドキュメントは、以下の3点セットを配布・利用することを前提とした
正式な詳細マニュアルです。

■ 配布ファイル一覧
1. README_ThinkPad_JIS_RDP_Keymap_Manual.txt（本書）
2. ThinkPad_JIS_RDP_Keymap_v1_3.ahk
3. ThinkPad_JIS_RDP_Keymap_v1_3.exe

※ exe 版で問題が出る環境向けに、.ahk 版も同梱しています。

----------------------------------------

■ このツールについて
本ツールは、ThinkPad 日本語キーボード（JIS / 106・109配列）を使用して、
US配列として認識される Windows 環境（主に RDP 接続先）を
JIS配列の感覚で操作できるようにするためのキー配列補正ツールです。

RDP 環境では、以下のような問題が発生しがちです。

- @ や [ ] の位置がUS配列になる
- Shift + 数字キーの記号が英語配列のままになる
- ろキーや ^ キーの位置がずれる

本ツールはこれらを「JIS配列の手癖」に近づけます。

----------------------------------------

■ 動作環境
- Windows（RDP 接続先側）
- ThinkPad 日本語キーボード（JIS）

【.exe 版を使う場合】
- 追加ソフト不要

【.ahk 版を使う場合】
- AutoHotkey v1 が必要（v2 では不可）

※ クライアント側（ノートPC）ではなく、
　**RDP先の Windows に常駐**させます。

----------------------------------------

■ exe版と ahk版の違い

【exe版】
- AutoHotkey をインストールしなくても動作
- セキュリティポリシーにより実行できない環境がある
- そのままスタートアップ登録しやすい

【ahk版】
- 中身を確認・編集できる
- セキュリティ的に安心と感じる人も多い
- AutoHotkey v1 が必要

どちらを使っても、機能は完全に同一です。

----------------------------------------

■ 起動方法

【exe版】
- ThinkPad_JIS_RDP_Keymap_v1_3.exe をダブルクリック

【ahk版】
1. AutoHotkey v1 をインストール
2. ThinkPad_JIS_RDP_Keymap_v1_3.ahk をダブルクリック

起動直後は、キー補正が **ON** の状態です。

----------------------------------------

■ 基本操作
- Ctrl + Alt + K
  キー補正の ON / OFF を手動で切り替えます

- Ctrl + Alt + H
  KeyHistory を表示（スキャンコード確認用）

※ v1.3 では、自動切り替え機能は廃止しています。
　誤動作防止のため、手動トグルのみです。

----------------------------------------

■ 補正されるキー一覧

【数字段 + Shift（JIS準拠）】
- Shift + 2 → "
- Shift + 6 → &
- Shift + 7 → '
- Shift + 8 → (
- Shift + 9 → )
- Shift + - → =
- Shift + 0 → 0（US配列の ) を抑制）

【記号キー（右手側）】
- @ / `
- [ / ]
- { / }
- ; / +
- : / *
- ろキー → \ / _
- ^ / ~（へキー）

----------------------------------------

■ IME 制御キーについて
以下のキーは文字変換を行わず、
キー入力としてそのまま RDP 先へ送信されます。

- 半角／全角
- 無変換
- 変換
- ひらがな／カタカナ

Google 日本語入力（Google IME）では、
これらのキーは状態や設定によって挙動が変わります。

本ツールでは挙動を固定せず、
**「素通し」**としています。

----------------------------------------

■ 右上の \ キーについて（重要）
ThinkPad JIS キーボード右上にある \ キーは、
以下の理由により補正対象外としています。

- US配列では VK_OEM 系として扱われる
- RDP 経由で別キーに再解釈されやすい
- AutoHotkey で補正すると他キーと衝突しやすい

そのため本ツールでは、
- ろキー側の \ を正規のバックスラッシュとして使用
- 右上の \ キーは未対応（放置）

という設計になっています。

----------------------------------------

■ トラブルシューティング

・キー挙動がおかしい場合
→ 他の AutoHotkey スクリプトが同時に起動していないか確認

・exe が起動しない場合
→ ahk 版を使用してください

・文字化けや起動エラーが出る場合（ahk版）
→ ファイルを ANSI（Shift-JIS）で保存

----------------------------------------

■ 設計方針まとめ
- 無理に全キーを直さない
- 衝突しやすいキーはあえて触らない
- 日常使用で困らない範囲を最優先

----------------------------------------

■ まとめ
本ツールは、
ThinkPad + JIS + RDP + US配列
という複雑な環境を、
「考えずに使える状態」に戻すための実用品です。

exe 版と ahk 版を併用できるため、
幅広い環境での利用を想定しています。

========================================
