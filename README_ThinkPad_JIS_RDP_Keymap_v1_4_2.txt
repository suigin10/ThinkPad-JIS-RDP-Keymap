ThinkPad_JIS_RDP_Keymap 使用マニュアル
=================================

1. 概要
--------
本ツールは、ThinkPad の JIS キーボードを使用しつつ、
RDP 接続先を US 配列前提で快適に運用するための
キー入力補助ユーティリティです。

AutoHotkey 版（.ahk）および実行ファイル版（.exe）の
どちらでも同一の挙動を提供します。


2. 動作環境
-----------
- Windows 10 / Windows 11
- ThinkPad JIS キーボード
- RDP 接続先：US 配列想定
- Google 日本語入力（推奨）

3. 同梱ファイル
---------------
以下のファイルを同一フォルダに配置してください。

- ThinkPad_JIS_RDP_Keymap_v1_4_2.exe
- ThinkPad_JIS_RDP_Keymap_v1_4_2.ahk
- icon_US_blue.ico
- icon_JA_red.ico

※ exe を使用する場合、.ahk は不要です。
※ アイコンファイルが無い場合、タスクトレイは既定のアイコンになります。


4. 起動方法
-----------
- exe 版：
  ThinkPad_JIS_RDP_Keymap_v1_4_2.exe をダブルクリック

- ahk 版：
  ThinkPad_JIS_RDP_Keymap_v1_4_2.ahk をダブルクリック
  （AutoHotkey v1.x が必要です）

※ exe 版と ahk 版を同時に起動しないでください。


5. 基本動作
-----------
起動すると、タスクトレイに常駐します。
起動直後は US モードです。

本ツールは以下の2つの機能を提供します。

- JIS FIX（US/JA）切り替え
- Alt-IME 操作（左右 Alt）


6. US / JA（JIS FIX）切り替え
------------------------------
以下のキーで切り替えます。

- Ctrl + Alt + K

US モード：
- RDP 接続先 US 配列前提
- 余計なキー変換を行いません

JA（JIS FIX）モード：
- RDP 先での JIS / US 差分を補正します

現在の状態はタスクトレイアイコンで確認できます。


7. Alt-IME 操作
---------------
US モード時、左右 Alt に以下の役割を割り当てています。

- 左 Alt 単押し：IME OFF（英数入力）
- 右 Alt 単押し：IME ON（日本語入力）


※ Alt + 他キーのショートカット操作には影響しません。
※ 単押しのみが対象です。


8. Alt メニュー奪取抑制について
--------------------------------
Windows アプリ（特にメモ帳）では、Alt 単押しで
上部メニューにフォーカスが移動することがあります。

本ツールでは、この挙動を抑制するための処理を組み込んでいます。

ただし、Alt は OS 側で特別扱いされるキーのため、
タイミングによってはごく稀にメニューが有効になることがあります。
これは仕様上の制限となります。


9. タスクトレイアイコン
------------------------
- US モード：US アイコン
- JA（JIS FIX）モード：JA アイコン

アイコンが正しく表示されない場合は、
icon_US_blue.ico / icon_JA_red.ico の配置を確認してください。


10. トラブルシューティング
--------------------------
■ 動作が不安定 / 切り替えがおかしい
- 多重起動していないか確認してください
- すべて終了後、再起動してから1つだけ起動してください

■ Ctrl+Alt+K が反応しない
- 他アプリのショートカットに割り当てられている可能性があります
- キー割り当てはスクリプト内で変更可能です


11. 終了方法
-------------
タスクトレイアイコンを右クリックし、
「Exit」を選択してください。


12. 注意事項
------------
- 管理者権限で起動したアプリに対して使用する場合は、
  本ツールも管理者権限で起動してください
- OS や IME の仕様変更により挙動が変わる可能性があります
