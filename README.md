Bugfix release.
Fixed an issue where Alt tap was interpreted as Alt+Esc,
causing unstable Alt-IME behavior.

Alt-IME now works reliably without sending Esc.

---

バグ修正リリースです。
Alt単押し時に Alt+Esc と誤認識される問題を修正しました。

Esc を送らない方式に変更し、
Alt-IME の動作が安定しています。

---
ThinkPad_JIS_RDP_Keymap_v1_4_1
===================================

■ 概要
本ツールは、ThinkPadの日本語(JIS)キーボードを使用して
「US配列として動作しているRDP先Windows」を
違和感なく操作するためのユーティリティです。

以下の2つの問題を主に解決します。

1. JISキーボード特有の記号配置が、US配列RDP先で崩れる問題
2. RDP環境でも安定して使える Alt-IME 風の入力切替

本バージョン v1.4.1 は、Alt-IME挙動の誤作動を修正した
安定版（バグ修正版）です。

--------------------------------------------------
■ 動作環境
- Windows 10 / Windows 11
- ThinkPad 日本語(JIS)キーボード
- RDP接続先が US配列として動作するWindows
- Google IME（推奨）

--------------------------------------------------
■ 配布ファイル構成

【AHK版】
- ThinkPad_JIS_RDP_Keymap_v1_4_1.ahk
- icon_US_blue.ico
- icon_JA_red.ico

【EXE版】
- ThinkPad_JIS_RDP_Keymap_v1_4_1.exe
  ※ exe版ではアイコンは内部に埋め込まれています

--------------------------------------------------
■ 起動と基本動作

起動するとタスクトレイに常駐します。

● 起動直後の状態（デフォルト）
- FIX OFF（USモード）
- トレイアイコン：青「US」

これは誤動作を防ぐための「安全側スタート」です。
通常のUS配列キーボードとして振る舞います。

--------------------------------------------------
■ モード切替

Ctrl + Alt + K

でモードをトグル切替できます。

--------------------------------------------------
■ FIX OFF（USモード）

トレイアイコン：US（青）

・JIS→US記号補正は無効
・Alt-IME 機能が有効

【Alt-IME 挙動】
- 左Alt を単押し → 英数入力（無変換キー相当）
- 右Alt を単押し → 日本語入力（変換キー相当）

※ Altを押しながら他のキーを押した場合
  (Alt+Tab / Alt+F4 / メニュー操作 等)
  → 通常の Alt としてそのまま動作します

※ 本バージョンでは Alt 単押し時に Esc を送らないため、
   Alt+Esc と誤認識される問題は発生しません。

--------------------------------------------------
■ FIX ON（JAモード）

トレイアイコン：JA（赤）

・JISキーボードの記号配置を
  US配列RDP環境向けに補正します
・Alt-IME 機能は無効（干渉防止）

【主な補正内容】
- @ [ ] ; : \ ^ ~ _ などのJIS特有記号
- Shift付き記号の位置ズレ
- JIS準拠の () 配置

--------------------------------------------------
■ Google IME 推奨設定（重要）

Alt-IME 機能を正しく使うため、
Google IME のキー設定を以下にしておくことを推奨します。

- 無変換キー：英数入力
- 変換キー　：ひらがな入力

--------------------------------------------------
■ AHK版の使い方

1. 以下の3ファイルを同じフォルダに配置
   - ThinkPad_JIS_RDP_Keymap_v1_4_1.ahk
   - icon_US_blue.ico
   - icon_JA_red.ico

2. ThinkPad_JIS_RDP_Keymap_v1_4_1.ahk を実行

--------------------------------------------------
■ EXE版の作成方法

1. 上記3ファイルを同じフォルダに配置
2. .ahk を右クリック →「Compile Script」
3. ThinkPad_JIS_RDP_Keymap_v1_4_1.exe が生成されます

--------------------------------------------------
■ トラブルシューティング

● Altを押すとメニューにフォーカスが行く
→ 本ツールでは MenuMaskKey を使用して抑制しています。
  Altは「短くタップ」する使い方を推奨します。

● IMEが切り替わらない
→ RDP環境では imm32 による IME制御が効かない場合があります。
  本ツールは 変換 / 無変換キー送出方式を採用しています。

--------------------------------------------------
■ ライセンス・注意

- 個人利用・改変は自由
- 自己責任で使用してください
- 本ツールは非公式であり、メーカー等とは無関係です

--------------------------------------------------
■ 最後に

ThinkPad JIS × US配列RDP という
非常にニッチで厄介な環境を、
「何も考えずに使える」状態にすることを目的としたツールです。

同じ問題で困っている方の助けになれば幸いです。
